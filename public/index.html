// Add an async ensureSignedIn() helper that checks firebase.auth().currentUser and prompts for Google login if not signed in.
async function ensureSignedIn() {
    const user = firebase.auth().currentUser;
    if (!user) {
        // Trigger Google login
        const provider = new firebase.auth.GoogleAuthProvider();
        await firebase.auth().signInWithPopup(provider);
    }
}

// Example function writing to Firestore
async function writeData() {
    await ensureSignedIn(); // Prepend await ensureSignedIn();
    await db.collection('yourCollection').set({ yourData });
}

// Example function updating Firestore
async function updateData() {
    await ensureSignedIn(); // Prepend await ensureSignedIn();
    await db.collection('yourCollection').update({ yourData });
}